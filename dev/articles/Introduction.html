<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction â€¢ openxlsx</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Introduction">
<meta property="og:description" content="openxlsx">
<meta name="robots" content="noindex">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">openxlsx</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="In-development version">4.2.4.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Formatting.html">Formating with xlsx</a>
    </li>
    <li>
      <a href="../articles/Introduction.html">Introduction</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/ycphs/openxlsx/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="Introduction_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Introduction</h1>
                        <h4 class="author">Alexander Walker, Philipp Schauberger</h4>
            
            <h4 class="date">2021-11-08</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/ycphs/openxlsx/blob/master/vignettes/Introduction.Rmd"><code>vignettes/Introduction.Rmd</code></a></small>
      <div class="hidden name"><code>Introduction.Rmd</code></div>

    </div>

    
    
<div id="basic-examples" class="section level2">
<h2 class="hasAnchor">
<a href="#basic-examples" class="anchor"></a>Basic Examples</h2>
<div id="write-xlsx" class="section level3">
<h3 class="hasAnchor">
<a href="#write-xlsx" class="anchor"></a>write.xlsx</h3>
<p>The simplest way to write to a workbook is write.xlsx(). By default, write.xlsx calls writeData. If asTable is TRUE write.xlsx will write x as an Excel table.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## write to working directory</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ycphs.github.io/openxlsx/index.html">openxlsx</a></span><span class="op">)</span>
<span class="fu"><a href="../reference/write.xlsx.html">write.xlsx</a></span><span class="op">(</span><span class="va">iris</span>, file <span class="op">=</span> <span class="st">"writeXLSX1.xlsx"</span><span class="op">)</span>
<span class="fu"><a href="../reference/write.xlsx.html">write.xlsx</a></span><span class="op">(</span><span class="va">iris</span>, file <span class="op">=</span> <span class="st">"writeXLSXTable1.xlsx"</span>, asTable <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
</div>
<div id="write-list-of-data-frames-to-xlsx-file" class="section level3">
<h3 class="hasAnchor">
<a href="#write-list-of-data-frames-to-xlsx-file" class="anchor"></a>write list of data.frames to xlsx-file</h3>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## write a list of data.frames to individual worksheets using list names as worksheet names</span>
<span class="va">l</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">"IRIS"</span> <span class="op">=</span> <span class="va">iris</span>, <span class="st">"MTCARS"</span> <span class="op">=</span> <span class="va">mtcars</span><span class="op">)</span>
<span class="fu"><a href="../reference/write.xlsx.html">write.xlsx</a></span><span class="op">(</span><span class="va">l</span>, file <span class="op">=</span> <span class="st">"writeXLSX2.xlsx"</span><span class="op">)</span>
<span class="fu"><a href="../reference/write.xlsx.html">write.xlsx</a></span><span class="op">(</span><span class="va">l</span>, file <span class="op">=</span> <span class="st">"writeXLSXTable2.xlsx"</span>, asTable <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
</div>
<div id="write-xlsx-also-accepts-styling-parameters" class="section level3">
<h3 class="hasAnchor">
<a href="#write-xlsx-also-accepts-styling-parameters" class="anchor"></a>write.xlsx also accepts styling parameters</h3>
<div id="the-simplest-way-is-to-set-default-options-and-set-column-class" class="section level4">
<h4 class="hasAnchor">
<a href="#the-simplest-way-is-to-set-default-options-and-set-column-class" class="anchor"></a>The simplest way is to set default options and set column class</h4>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span><span class="st">"openxlsx.borderColour"</span> <span class="op">=</span> <span class="st">"#4F80BD"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span><span class="st">"openxlsx.borderStyle"</span> <span class="op">=</span> <span class="st">"thin"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span><span class="st">"openxlsx.dateFormat"</span> <span class="op">=</span> <span class="st">"mm/dd/yyyy"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span><span class="st">"openxlsx.datetimeFormat"</span> <span class="op">=</span> <span class="st">"yyyy-mm-dd hh:mm:ss"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span><span class="st">"openxlsx.numFmt"</span> <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="co">## For default style rounding of numeric columns</span>

<span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="st">"Date"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.Date</a></span><span class="op">(</span><span class="op">)</span><span class="op">-</span><span class="fl">0</span><span class="op">:</span><span class="fl">19</span>, <span class="st">"LogicalT"</span> <span class="op">=</span> <span class="cn">TRUE</span>,
                 <span class="st">"Time"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.time</a></span><span class="op">(</span><span class="op">)</span><span class="op">-</span><span class="fl">0</span><span class="op">:</span><span class="fl">19</span><span class="op">*</span><span class="fl">60</span><span class="op">*</span><span class="fl">60</span>,
                 <span class="st">"Cash"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"$"</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">)</span>, <span class="st">"Cash2"</span> <span class="op">=</span> <span class="fl">31</span><span class="op">:</span><span class="fl">50</span>,
                 <span class="st">"hLink"</span> <span class="op">=</span> <span class="st">"https://CRAN.R-project.org/"</span>,
                 <span class="st">"Percentage"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, length.out<span class="op">=</span><span class="fl">20</span><span class="op">)</span>,
                 <span class="st">"TinyNumbers"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">20</span><span class="op">)</span> <span class="op">/</span> <span class="fl">1E9</span>,  stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">Cash</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"currency"</span>
<span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">Cash2</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"accounting"</span>
<span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">hLink</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"hyperlink"</span>
<span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">Percentage</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"percentage"</span>
<span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">TinyNumbers</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"scientific"</span>

<span class="fu"><a href="../reference/write.xlsx.html">write.xlsx</a></span><span class="op">(</span><span class="va">df</span>, <span class="st">"writeXLSX3.xlsx"</span><span class="op">)</span>
<span class="fu"><a href="../reference/write.xlsx.html">write.xlsx</a></span><span class="op">(</span><span class="va">df</span>, file <span class="op">=</span> <span class="st">"writeXLSXTable3.xlsx"</span>, asTable <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
</div>
</div>
</div>
<div id="workbook-styles" class="section level2">
<h2 class="hasAnchor">
<a href="#workbook-styles" class="anchor"></a>Workbook styles</h2>
<div id="define-a-style-for-column-headers" class="section level3">
<h3 class="hasAnchor">
<a href="#define-a-style-for-column-headers" class="anchor"></a>define a style for column headers</h3>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">hs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createStyle.html">createStyle</a></span><span class="op">(</span>fontColour <span class="op">=</span> <span class="st">"#ffffff"</span>, fgFill <span class="op">=</span> <span class="st">"#4F80BD"</span>,
                  halign <span class="op">=</span> <span class="st">"center"</span>, valign <span class="op">=</span> <span class="st">"center"</span>, textDecoration <span class="op">=</span> <span class="st">"Bold"</span>,
                  border <span class="op">=</span> <span class="st">"TopBottomLeftRight"</span>, textRotation <span class="op">=</span> <span class="fl">45</span><span class="op">)</span>

<span class="fu"><a href="../reference/write.xlsx.html">write.xlsx</a></span><span class="op">(</span><span class="va">iris</span>, file <span class="op">=</span> <span class="st">"writeXLSX4.xlsx"</span>, borders <span class="op">=</span> <span class="st">"rows"</span>, headerStyle <span class="op">=</span> <span class="va">hs</span><span class="op">)</span>
<span class="fu"><a href="../reference/write.xlsx.html">write.xlsx</a></span><span class="op">(</span><span class="va">iris</span>, file <span class="op">=</span> <span class="st">"writeXLSX5.xlsx"</span>, borders <span class="op">=</span> <span class="st">"columns"</span>, headerStyle <span class="op">=</span> <span class="va">hs</span><span class="op">)</span>

<span class="fu"><a href="../reference/write.xlsx.html">write.xlsx</a></span><span class="op">(</span><span class="va">iris</span>, <span class="st">"writeXLSXTable4.xlsx"</span>, asTable <span class="op">=</span> <span class="cn">TRUE</span>,
headerStyle <span class="op">=</span> <span class="fu"><a href="../reference/createStyle.html">createStyle</a></span><span class="op">(</span>textRotation <span class="op">=</span> <span class="fl">45</span><span class="op">)</span><span class="op">)</span></code></pre></div>
</div>
<div id="when-writing-a-list-the-stylings-will-apply-to-all-list-elements" class="section level3">
<h3 class="hasAnchor">
<a href="#when-writing-a-list-the-stylings-will-apply-to-all-list-elements" class="anchor"></a>When writing a list, the stylings will apply to all list elements</h3>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">l</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">"IRIS"</span> <span class="op">=</span> <span class="va">iris</span>, <span class="st">"colClasses"</span> <span class="op">=</span> <span class="va">df</span><span class="op">)</span>
<span class="fu"><a href="../reference/write.xlsx.html">write.xlsx</a></span><span class="op">(</span><span class="va">l</span>, file <span class="op">=</span> <span class="st">"writeXLSX6.xlsx"</span>, borders <span class="op">=</span> <span class="st">"columns"</span>, headerStyle <span class="op">=</span> <span class="va">hs</span><span class="op">)</span>
<span class="fu"><a href="../reference/write.xlsx.html">write.xlsx</a></span><span class="op">(</span><span class="va">l</span>, file <span class="op">=</span> <span class="st">"writeXLSXTable5.xlsx"</span>, asTable <span class="op">=</span> <span class="cn">TRUE</span>, tableStyle <span class="op">=</span> <span class="st">"TableStyleLight2"</span><span class="op">)</span>

<span class="fu"><a href="../reference/openXL.html">openXL</a></span><span class="op">(</span><span class="st">"writeXLSX6.xlsx"</span><span class="op">)</span>
<span class="fu"><a href="../reference/openXL.html">openXL</a></span><span class="op">(</span><span class="st">"writeXLSXTable5.xlsx"</span><span class="op">)</span></code></pre></div>
</div>
<div id="write-xlsx-returns-the-workbook-object-for-further-editing" class="section level3">
<h3 class="hasAnchor">
<a href="#write-xlsx-returns-the-workbook-object-for-further-editing" class="anchor"></a>write.xlsx returns the workbook object for further editing</h3>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">wb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/write.xlsx.html">write.xlsx</a></span><span class="op">(</span><span class="va">iris</span>, <span class="st">"writeXLSX6.xlsx"</span><span class="op">)</span>
<span class="fu"><a href="../reference/setColWidths.html">setColWidths</a></span><span class="op">(</span><span class="va">wb</span>, sheet <span class="op">=</span> <span class="fl">1</span>, cols <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, widths <span class="op">=</span> <span class="fl">20</span><span class="op">)</span>
<span class="fu"><a href="../reference/saveWorkbook.html">saveWorkbook</a></span><span class="op">(</span><span class="va">wb</span>, <span class="st">"writeXLSX6.xlsx"</span>, overwrite <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
</div>
</div>
<div id="workbook-creation-walk-through" class="section level2">
<h2 class="hasAnchor">
<a href="#workbook-creation-walk-through" class="anchor"></a>Workbook creation walk-through</h2>
<div id="create-workbook-and-set-default-border-colour-and-style" class="section level3">
<h3 class="hasAnchor">
<a href="#create-workbook-and-set-default-border-colour-and-style" class="anchor"></a>create workbook and set default border Colour and style</h3>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span>
<span class="va">wb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createWorkbook.html">createWorkbook</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span><span class="st">"openxlsx.borderColour"</span> <span class="op">=</span> <span class="st">"#4F80BD"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span><span class="st">"openxlsx.borderStyle"</span> <span class="op">=</span> <span class="st">"thin"</span><span class="op">)</span>
<span class="fu"><a href="../reference/modifyBaseFont.html">modifyBaseFont</a></span><span class="op">(</span><span class="va">wb</span>, fontSize <span class="op">=</span> <span class="fl">10</span>, fontName <span class="op">=</span> <span class="st">"Arial Narrow"</span><span class="op">)</span></code></pre></div>
</div>
<div id="add-sheets" class="section level3">
<h3 class="hasAnchor">
<a href="#add-sheets" class="anchor"></a>Add Sheets</h3>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/addWorksheet.html">addWorksheet</a></span><span class="op">(</span><span class="va">wb</span>, sheetName <span class="op">=</span> <span class="st">"Motor Trend Car Road Tests"</span>, gridLines <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="fu"><a href="../reference/addWorksheet.html">addWorksheet</a></span><span class="op">(</span><span class="va">wb</span>, sheetName <span class="op">=</span> <span class="st">"Iris"</span>, gridLines <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
</div>
<div id="write-data-to-sheet-1" class="section level3">
<h3 class="hasAnchor">
<a href="#write-data-to-sheet-1" class="anchor"></a>write data to sheet 1</h3>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/freezePane.html">freezePane</a></span><span class="op">(</span><span class="va">wb</span>, sheet <span class="op">=</span> <span class="fl">1</span>, firstRow <span class="op">=</span> <span class="cn">TRUE</span>, firstCol <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co">## freeze first row and column</span>
<span class="fu"><a href="../reference/writeDataTable.html">writeDataTable</a></span><span class="op">(</span><span class="va">wb</span>, sheet <span class="op">=</span> <span class="fl">1</span>, x <span class="op">=</span> <span class="va">mtcars</span>,
colNames <span class="op">=</span> <span class="cn">TRUE</span>, rowNames <span class="op">=</span> <span class="cn">TRUE</span>,
tableStyle <span class="op">=</span> <span class="st">"TableStyleLight9"</span><span class="op">)</span>

<span class="fu"><a href="../reference/setColWidths.html">setColWidths</a></span><span class="op">(</span><span class="va">wb</span>, sheet <span class="op">=</span> <span class="fl">1</span>, cols <span class="op">=</span> <span class="st">"A"</span>, widths <span class="op">=</span> <span class="fl">18</span><span class="op">)</span></code></pre></div>
</div>
<div id="write-data-to-sheet-2" class="section level3">
<h3 class="hasAnchor">
<a href="#write-data-to-sheet-2" class="anchor"></a>write data to sheet 2</h3>
<p>iris data.frame is added as excel table on sheet 2.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/writeDataTable.html">writeDataTable</a></span><span class="op">(</span><span class="va">wb</span>, sheet <span class="op">=</span> <span class="fl">2</span>, <span class="va">iris</span>, startCol <span class="op">=</span> <span class="st">"K"</span>, startRow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>

<span class="fu">qplot</span><span class="op">(</span>data<span class="op">=</span><span class="va">iris</span>, x <span class="op">=</span> <span class="va">Sepal.Length</span>, y<span class="op">=</span> <span class="va">Sepal.Width</span>, colour <span class="op">=</span> <span class="va">Species</span><span class="op">)</span>
<span class="fu"><a href="../reference/insertPlot.html">insertPlot</a></span><span class="op">(</span><span class="va">wb</span>, <span class="fl">2</span>, xy<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"B"</span>, <span class="fl">16</span><span class="op">)</span><span class="op">)</span> <span class="co">## insert plot at cell B16</span>

<span class="va">means</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html">aggregate</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">iris</span><span class="op">[</span>,<span class="op">-</span><span class="fl">5</span><span class="op">]</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">iris</span><span class="op">$</span><span class="va">Species</span><span class="op">)</span>, FUN <span class="op">=</span> <span class="va">mean</span><span class="op">)</span>
<span class="va">vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html">aggregate</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">iris</span><span class="op">[</span>,<span class="op">-</span><span class="fl">5</span><span class="op">]</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">iris</span><span class="op">$</span><span class="va">Species</span><span class="op">)</span>, FUN <span class="op">=</span> <span class="va">var</span><span class="op">)</span></code></pre></div>
</div>
<div id="add-write-group-means" class="section level3">
<h3 class="hasAnchor">
<a href="#add-write-group-means" class="anchor"></a>add write group means</h3>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">headSty</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createStyle.html">createStyle</a></span><span class="op">(</span>fgFill<span class="op">=</span><span class="st">"#DCE6F1"</span>, halign<span class="op">=</span><span class="st">"center"</span>, border <span class="op">=</span> <span class="st">"TopBottomLeftRight"</span><span class="op">)</span>
<span class="fu"><a href="../reference/writeData.html">writeData</a></span><span class="op">(</span><span class="va">wb</span>, <span class="fl">2</span>, x <span class="op">=</span> <span class="st">"Iris dataset group means"</span>, startCol <span class="op">=</span> <span class="fl">2</span>, startRow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="fu"><a href="../reference/writeData.html">writeData</a></span><span class="op">(</span><span class="va">wb</span>, <span class="fl">2</span>, x <span class="op">=</span> <span class="va">means</span>, startCol <span class="op">=</span> <span class="st">"B"</span>, startRow<span class="op">=</span><span class="fl">3</span>, borders<span class="op">=</span><span class="st">"rows"</span>, headerStyle <span class="op">=</span> <span class="va">headSty</span><span class="op">)</span></code></pre></div>
</div>
<div id="add-write-group-variances" class="section level3">
<h3 class="hasAnchor">
<a href="#add-write-group-variances" class="anchor"></a>add write group variances</h3>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/writeData.html">writeData</a></span><span class="op">(</span><span class="va">wb</span>, <span class="fl">2</span>, x <span class="op">=</span> <span class="st">"Iris dataset group variances"</span>, startCol <span class="op">=</span> <span class="fl">2</span>, startRow <span class="op">=</span> <span class="fl">9</span><span class="op">)</span>
<span class="fu"><a href="../reference/writeData.html">writeData</a></span><span class="op">(</span><span class="va">wb</span>, <span class="fl">2</span>, x<span class="op">=</span> <span class="va">vars</span>, startCol <span class="op">=</span> <span class="st">"B"</span>, startRow<span class="op">=</span><span class="fl">10</span>, borders<span class="op">=</span><span class="st">"columns"</span>,
headerStyle <span class="op">=</span> <span class="va">headSty</span><span class="op">)</span>

<span class="fu"><a href="../reference/setColWidths.html">setColWidths</a></span><span class="op">(</span><span class="va">wb</span>, <span class="fl">2</span>, cols<span class="op">=</span><span class="fl">2</span><span class="op">:</span><span class="fl">6</span>, widths <span class="op">=</span> <span class="fl">12</span><span class="op">)</span> <span class="co">## width is recycled for each col</span>
<span class="fu"><a href="../reference/setColWidths.html">setColWidths</a></span><span class="op">(</span><span class="va">wb</span>, <span class="fl">2</span>, cols<span class="op">=</span><span class="fl">11</span><span class="op">:</span><span class="fl">15</span>, widths <span class="op">=</span> <span class="fl">15</span><span class="op">)</span></code></pre></div>
</div>
<div id="add-style-mean-variance-table-headers" class="section level3">
<h3 class="hasAnchor">
<a href="#add-style-mean-variance-table-headers" class="anchor"></a>add style mean &amp; variance table headers</h3>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">s1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createStyle.html">createStyle</a></span><span class="op">(</span>fontSize<span class="op">=</span><span class="fl">14</span>, textDecoration<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"bold"</span>, <span class="st">"italic"</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/addStyle.html">addStyle</a></span><span class="op">(</span><span class="va">wb</span>, <span class="fl">2</span>, style <span class="op">=</span> <span class="va">s1</span>, rows<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">9</span><span class="op">)</span>, cols<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></code></pre></div>
</div>
<div id="save-workbook" class="section level3">
<h3 class="hasAnchor">
<a href="#save-workbook" class="anchor"></a>save workbook</h3>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/saveWorkbook.html">saveWorkbook</a></span><span class="op">(</span><span class="va">wb</span>, <span class="st">"basics.xlsx"</span>, overwrite <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co">## save to working directory</span></code></pre></div>
</div>
</div>
<div id="gallery" class="section level2">
<h2 class="hasAnchor">
<a href="#gallery" class="anchor"></a>Gallery</h2>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## inspired by xtable gallery</span>
<span class="co">#https://CRAN.R-project.org/package=xtable/vignettes/xtableGallery.pdf</span>

<span class="co">## Create a new workbook</span>
<span class="va">wb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createWorkbook.html">createWorkbook</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">tli</span>, package <span class="op">=</span> <span class="st">"xtable"</span><span class="op">)</span>

<span class="co">## data.frame</span>
<span class="va">test.n</span> <span class="op">&lt;-</span> <span class="st">"data.frame"</span>
<span class="va">my.df</span> <span class="op">&lt;-</span> <span class="va">tli</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="op">]</span>
<span class="fu"><a href="../reference/addWorksheet.html">addWorksheet</a></span><span class="op">(</span>wb <span class="op">=</span> <span class="va">wb</span>, sheetName <span class="op">=</span> <span class="va">test.n</span><span class="op">)</span>
<span class="fu"><a href="../reference/writeData.html">writeData</a></span><span class="op">(</span>wb <span class="op">=</span> <span class="va">wb</span>, sheet <span class="op">=</span> <span class="va">test.n</span>, x <span class="op">=</span> <span class="va">my.df</span>, borders <span class="op">=</span> <span class="st">"n"</span><span class="op">)</span>

<span class="co">## matrix</span>
<span class="va">test.n</span> <span class="op">&lt;-</span> <span class="st">"matrix"</span>
<span class="va">design.matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html">model.matrix</a></span><span class="op">(</span><span class="op">~</span> <span class="va">sex</span> <span class="op">*</span> <span class="va">grade</span>, data <span class="op">=</span> <span class="va">my.df</span><span class="op">)</span>
<span class="fu"><a href="../reference/addWorksheet.html">addWorksheet</a></span><span class="op">(</span>wb <span class="op">=</span> <span class="va">wb</span>, sheetName <span class="op">=</span> <span class="va">test.n</span><span class="op">)</span>
<span class="fu"><a href="../reference/writeData.html">writeData</a></span><span class="op">(</span>wb <span class="op">=</span> <span class="va">wb</span>, sheet <span class="op">=</span> <span class="va">test.n</span>, x <span class="op">=</span> <span class="va">design.matrix</span><span class="op">)</span>

<span class="co">## aov</span>
<span class="va">test.n</span> <span class="op">&lt;-</span> <span class="st">"aov"</span>
<span class="va">fm1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span><span class="va">tlimth</span> <span class="op">~</span> <span class="va">sex</span> <span class="op">+</span> <span class="va">ethnicty</span> <span class="op">+</span> <span class="va">grade</span> <span class="op">+</span> <span class="va">disadvg</span>, data <span class="op">=</span> <span class="va">tli</span><span class="op">)</span>
<span class="fu"><a href="../reference/addWorksheet.html">addWorksheet</a></span><span class="op">(</span>wb <span class="op">=</span> <span class="va">wb</span>, sheetName <span class="op">=</span> <span class="va">test.n</span><span class="op">)</span>
<span class="fu"><a href="../reference/writeData.html">writeData</a></span><span class="op">(</span>wb <span class="op">=</span> <span class="va">wb</span>, sheet <span class="op">=</span> <span class="va">test.n</span>, x <span class="op">=</span> <span class="va">fm1</span><span class="op">)</span>

<span class="co">## lm</span>
<span class="va">test.n</span> <span class="op">&lt;-</span> <span class="st">"lm"</span>
<span class="va">fm2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">tlimth</span> <span class="op">~</span> <span class="va">sex</span><span class="op">*</span><span class="va">ethnicty</span>, data <span class="op">=</span> <span class="va">tli</span><span class="op">)</span>
<span class="fu"><a href="../reference/addWorksheet.html">addWorksheet</a></span><span class="op">(</span>wb <span class="op">=</span> <span class="va">wb</span>, sheetName <span class="op">=</span> <span class="va">test.n</span><span class="op">)</span>
<span class="fu"><a href="../reference/writeData.html">writeData</a></span><span class="op">(</span>wb <span class="op">=</span> <span class="va">wb</span>, sheet <span class="op">=</span> <span class="va">test.n</span>, x <span class="op">=</span> <span class="va">fm2</span><span class="op">)</span>

<span class="co">## anova 1 </span>
<span class="va">test.n</span> <span class="op">&lt;-</span> <span class="st">"anova"</span>
<span class="va">my.anova</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">fm2</span><span class="op">)</span>
<span class="fu"><a href="../reference/addWorksheet.html">addWorksheet</a></span><span class="op">(</span>wb <span class="op">=</span> <span class="va">wb</span>, sheetName <span class="op">=</span> <span class="va">test.n</span><span class="op">)</span>
<span class="fu"><a href="../reference/writeData.html">writeData</a></span><span class="op">(</span>wb <span class="op">=</span> <span class="va">wb</span>, sheet <span class="op">=</span> <span class="va">test.n</span>, x <span class="op">=</span> <span class="va">my.anova</span><span class="op">)</span>

<span class="co">## anova 2</span>
<span class="va">test.n</span> <span class="op">&lt;-</span> <span class="st">"anova2"</span>
<span class="va">fm2b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">tlimth</span> <span class="op">~</span> <span class="va">ethnicty</span>, data <span class="op">=</span> <span class="va">tli</span><span class="op">)</span>
<span class="va">my.anova2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">fm2b</span>, <span class="va">fm2</span><span class="op">)</span>
<span class="fu"><a href="../reference/addWorksheet.html">addWorksheet</a></span><span class="op">(</span>wb <span class="op">=</span> <span class="va">wb</span>, sheetName <span class="op">=</span> <span class="va">test.n</span><span class="op">)</span>
<span class="fu"><a href="../reference/writeData.html">writeData</a></span><span class="op">(</span>wb <span class="op">=</span> <span class="va">wb</span>, sheet <span class="op">=</span> <span class="va">test.n</span>, x <span class="op">=</span> <span class="va">my.anova2</span><span class="op">)</span>

<span class="co">## glm</span>
<span class="va">test.n</span> <span class="op">&lt;-</span> <span class="st">"glm"</span>
<span class="va">fm3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="va">disadvg</span> <span class="op">~</span> <span class="va">ethnicty</span><span class="op">*</span><span class="va">grade</span>, data <span class="op">=</span> <span class="va">tli</span>, family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html">binomial</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/addWorksheet.html">addWorksheet</a></span><span class="op">(</span>wb <span class="op">=</span> <span class="va">wb</span>, sheetName <span class="op">=</span> <span class="va">test.n</span><span class="op">)</span>
<span class="fu"><a href="../reference/writeData.html">writeData</a></span><span class="op">(</span>wb <span class="op">=</span> <span class="va">wb</span>, sheet <span class="op">=</span> <span class="va">test.n</span>, x <span class="op">=</span> <span class="va">fm3</span><span class="op">)</span>

<span class="co">## prcomp</span>
<span class="va">test.n</span> <span class="op">&lt;-</span> <span class="st">"prcomp"</span>
<span class="va">pr1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/prcomp.html">prcomp</a></span><span class="op">(</span><span class="va">USArrests</span><span class="op">)</span>
<span class="fu"><a href="../reference/addWorksheet.html">addWorksheet</a></span><span class="op">(</span>wb <span class="op">=</span> <span class="va">wb</span>, sheetName <span class="op">=</span> <span class="va">test.n</span><span class="op">)</span>
<span class="fu"><a href="../reference/writeData.html">writeData</a></span><span class="op">(</span>wb <span class="op">=</span> <span class="va">wb</span>, sheet <span class="op">=</span> <span class="va">test.n</span>, x <span class="op">=</span> <span class="va">pr1</span><span class="op">)</span>

<span class="co">## summary.prcomp</span>
<span class="va">test.n</span> <span class="op">&lt;-</span> <span class="st">"summary.prcomp"</span>
<span class="fu"><a href="../reference/addWorksheet.html">addWorksheet</a></span><span class="op">(</span>wb <span class="op">=</span> <span class="va">wb</span>, sheetName <span class="op">=</span> <span class="va">test.n</span><span class="op">)</span>
<span class="fu"><a href="../reference/writeData.html">writeData</a></span><span class="op">(</span>wb <span class="op">=</span> <span class="va">wb</span>, sheet <span class="op">=</span> <span class="va">test.n</span>, x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">pr1</span><span class="op">)</span><span class="op">)</span>

<span class="co">## simple table</span>
<span class="va">test.n</span> <span class="op">&lt;-</span> <span class="st">"table"</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">airquality</span><span class="op">)</span>
<span class="va">airquality</span><span class="op">$</span><span class="va">OzoneG80</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">airquality</span><span class="op">$</span><span class="va">Ozone</span> <span class="op">&gt;</span> <span class="fl">80</span>,
levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="cn">FALSE</span>, <span class="cn">TRUE</span><span class="op">)</span>,
labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Oz &lt;= 80"</span>, <span class="st">"Oz &gt; 80"</span><span class="op">)</span><span class="op">)</span>
<span class="va">airquality</span><span class="op">$</span><span class="va">Month</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">airquality</span><span class="op">$</span><span class="va">Month</span>,
levels <span class="op">=</span> <span class="fl">5</span><span class="op">:</span><span class="fl">9</span>,
labels <span class="op">=</span> <span class="va">month.abb</span><span class="op">[</span><span class="fl">5</span><span class="op">:</span><span class="fl">9</span><span class="op">]</span><span class="op">)</span>
<span class="va">my.table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span><span class="va">airquality</span>, <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">OzoneG80</span>,<span class="va">Month</span><span class="op">)</span> <span class="op">)</span>
<span class="fu"><a href="../reference/addWorksheet.html">addWorksheet</a></span><span class="op">(</span>wb <span class="op">=</span> <span class="va">wb</span>, sheetName <span class="op">=</span> <span class="va">test.n</span><span class="op">)</span>
<span class="fu"><a href="../reference/writeData.html">writeData</a></span><span class="op">(</span>wb <span class="op">=</span> <span class="va">wb</span>, sheet <span class="op">=</span> <span class="va">test.n</span>, x <span class="op">=</span> <span class="va">my.table</span><span class="op">)</span>

<span class="co">## survdiff 1</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/therneau/survival">survival</a></span><span class="op">)</span>
<span class="va">test.n</span> <span class="op">&lt;-</span> <span class="st">"survdiff1"</span>
<span class="fu"><a href="../reference/addWorksheet.html">addWorksheet</a></span><span class="op">(</span>wb <span class="op">=</span> <span class="va">wb</span>, sheetName <span class="op">=</span> <span class="va">test.n</span><span class="op">)</span>
<span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/survival/man/survdiff.html">survdiff</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html">Surv</a></span><span class="op">(</span><span class="va">futime</span>, <span class="va">fustat</span><span class="op">)</span> <span class="op">~</span> <span class="va">rx</span>, data <span class="op">=</span> <span class="va">ovarian</span><span class="op">)</span>
<span class="fu"><a href="../reference/writeData.html">writeData</a></span><span class="op">(</span>wb <span class="op">=</span> <span class="va">wb</span>, sheet <span class="op">=</span> <span class="va">test.n</span>, x <span class="op">=</span> <span class="va">x</span><span class="op">)</span>

<span class="co">## survdiff 2</span>
<span class="va">test.n</span> <span class="op">&lt;-</span> <span class="st">"survdiff2"</span>
<span class="fu"><a href="../reference/addWorksheet.html">addWorksheet</a></span><span class="op">(</span>wb <span class="op">=</span> <span class="va">wb</span>, sheetName <span class="op">=</span> <span class="va">test.n</span><span class="op">)</span>
<span class="va">expect</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/survival/man/survexp.html">survexp</a></span><span class="op">(</span><span class="va">futime</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/pkg/survival/man/ratetable.html">ratetable</a></span><span class="op">(</span>age<span class="op">=</span><span class="op">(</span><span class="va">accept.dt</span> <span class="op">-</span> <span class="va">birth.dt</span><span class="op">)</span>,
      sex<span class="op">=</span><span class="fl">1</span>,year<span class="op">=</span><span class="va">accept.dt</span>,race<span class="op">=</span><span class="st">"white"</span><span class="op">)</span>, <span class="va">jasa</span>, cohort<span class="op">=</span><span class="cn">FALSE</span>,
      ratetable<span class="op">=</span><span class="va">survexp.usr</span><span class="op">)</span>
<span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/survival/man/survdiff.html">survdiff</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html">Surv</a></span><span class="op">(</span><span class="va">jasa</span><span class="op">$</span><span class="va">futime</span>, <span class="va">jasa</span><span class="op">$</span><span class="va">fustat</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/offset.html">offset</a></span><span class="op">(</span><span class="va">expect</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/writeData.html">writeData</a></span><span class="op">(</span>wb <span class="op">=</span> <span class="va">wb</span>, sheet <span class="op">=</span> <span class="va">test.n</span>, x <span class="op">=</span> <span class="va">x</span><span class="op">)</span>

<span class="co">## coxph 1</span>
<span class="va">test.n</span> <span class="op">&lt;-</span> <span class="st">"coxph1"</span>
<span class="fu"><a href="../reference/addWorksheet.html">addWorksheet</a></span><span class="op">(</span>wb <span class="op">=</span> <span class="va">wb</span>, sheetName <span class="op">=</span> <span class="va">test.n</span><span class="op">)</span>
<span class="va">bladder</span><span class="op">$</span><span class="va">rx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">bladder</span><span class="op">$</span><span class="va">rx</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Pla"</span>,<span class="st">"Thi"</span><span class="op">)</span><span class="op">)</span>
<span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/survival/man/coxph.html">coxph</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html">Surv</a></span><span class="op">(</span><span class="va">stop</span>,<span class="va">event</span><span class="op">)</span> <span class="op">~</span> <span class="va">rx</span>, data <span class="op">=</span> <span class="va">bladder</span><span class="op">)</span>
<span class="fu"><a href="../reference/writeData.html">writeData</a></span><span class="op">(</span>wb <span class="op">=</span> <span class="va">wb</span>, sheet <span class="op">=</span> <span class="va">test.n</span>, x <span class="op">=</span> <span class="va">x</span><span class="op">)</span>

<span class="co">## coxph 2</span>
<span class="va">test.n</span> <span class="op">&lt;-</span> <span class="st">"coxph2"</span>
<span class="fu"><a href="../reference/addWorksheet.html">addWorksheet</a></span><span class="op">(</span>wb <span class="op">=</span> <span class="va">wb</span>, sheetName <span class="op">=</span> <span class="va">test.n</span><span class="op">)</span>
<span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/survival/man/coxph.html">coxph</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html">Surv</a></span><span class="op">(</span><span class="va">stop</span>,<span class="va">event</span><span class="op">)</span> <span class="op">~</span> <span class="va">rx</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/survival/man/cluster.html">cluster</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">bladder</span><span class="op">)</span>
<span class="fu"><a href="../reference/writeData.html">writeData</a></span><span class="op">(</span>wb <span class="op">=</span> <span class="va">wb</span>, sheet <span class="op">=</span> <span class="va">test.n</span>, x <span class="op">=</span> <span class="va">x</span><span class="op">)</span>

<span class="co">## cox.zph</span>
<span class="va">test.n</span> <span class="op">&lt;-</span> <span class="st">"cox.zph"</span>
<span class="fu"><a href="../reference/addWorksheet.html">addWorksheet</a></span><span class="op">(</span>wb <span class="op">=</span> <span class="va">wb</span>, sheetName <span class="op">=</span> <span class="va">test.n</span><span class="op">)</span>
<span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/survival/man/cox.zph.html">cox.zph</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/coxph.html">coxph</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html">Surv</a></span><span class="op">(</span><span class="va">futime</span>, <span class="va">fustat</span><span class="op">)</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">ecog.ps</span>,  data<span class="op">=</span><span class="va">ovarian</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/writeData.html">writeData</a></span><span class="op">(</span>wb <span class="op">=</span> <span class="va">wb</span>, sheet <span class="op">=</span> <span class="va">test.n</span>, x <span class="op">=</span> <span class="va">x</span><span class="op">)</span>

<span class="co">## summary.coxph 1</span>
<span class="va">test.n</span> <span class="op">&lt;-</span> <span class="st">"summary.coxph1"</span>
<span class="fu"><a href="../reference/addWorksheet.html">addWorksheet</a></span><span class="op">(</span>wb <span class="op">=</span> <span class="va">wb</span>, sheetName <span class="op">=</span> <span class="va">test.n</span><span class="op">)</span>
<span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/coxph.html">coxph</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html">Surv</a></span><span class="op">(</span><span class="va">stop</span>,<span class="va">event</span><span class="op">)</span> <span class="op">~</span> <span class="va">rx</span>, data <span class="op">=</span> <span class="va">bladder</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/writeData.html">writeData</a></span><span class="op">(</span>wb <span class="op">=</span> <span class="va">wb</span>, sheet <span class="op">=</span> <span class="va">test.n</span>, x <span class="op">=</span> <span class="va">x</span><span class="op">)</span>

<span class="co">## summary.coxph 2</span>
<span class="va">test.n</span> <span class="op">&lt;-</span> <span class="st">"summary.coxph2"</span>
<span class="fu"><a href="../reference/addWorksheet.html">addWorksheet</a></span><span class="op">(</span>wb <span class="op">=</span> <span class="va">wb</span>, sheetName <span class="op">=</span> <span class="va">test.n</span><span class="op">)</span>
<span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/coxph.html">coxph</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html">Surv</a></span><span class="op">(</span><span class="va">stop</span>,<span class="va">event</span><span class="op">)</span> <span class="op">~</span> <span class="va">rx</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/survival/man/cluster.html">cluster</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">bladder</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/writeData.html">writeData</a></span><span class="op">(</span>wb <span class="op">=</span> <span class="va">wb</span>, sheet <span class="op">=</span> <span class="va">test.n</span>, x <span class="op">=</span> <span class="va">x</span><span class="op">)</span>

<span class="co">## view without saving</span>
<span class="fu"><a href="../reference/openXL.html">openXL</a></span><span class="op">(</span><span class="va">wb</span><span class="op">)</span></code></pre></div>
</div>
<div id="further-examples" class="section level2">
<h2 class="hasAnchor">
<a href="#further-examples" class="anchor"></a>Further Examples</h2>
<div id="stock-price" class="section level3">
<h3 class="hasAnchor">
<a href="#stock-price" class="anchor"></a>Stock Price</h3>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span>

<span class="va">wb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createWorkbook.html">createWorkbook</a></span><span class="op">(</span><span class="op">)</span>

<span class="co">## read historical prices from yahoo finance</span>
<span class="va">ticker</span> <span class="op">&lt;-</span> <span class="st">"CBA.AX"</span>
<span class="va">csv.url</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"http://ichart.finance.yahoo.com/table.csv?s="</span>,
<span class="va">ticker</span>, <span class="st">"&amp;a=01&amp;b=9&amp;c=2009&amp;d=01&amp;e=9&amp;f=2014&amp;g=d&amp;ignore=.csv"</span><span class="op">)</span>
<span class="va">prices</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/connections.html">url</a></span><span class="op">(</span><span class="va">csv.url</span><span class="op">)</span>, as.is <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">prices</span><span class="op">$</span><span class="va">Date</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="va">prices</span><span class="op">$</span><span class="va">Date</span><span class="op">)</span>
<span class="va">close</span> <span class="op">&lt;-</span> <span class="va">prices</span><span class="op">$</span><span class="va">Close</span>
<span class="va">prices</span><span class="op">$</span><span class="va">logReturns</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">close</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">close</span><span class="op">)</span><span class="op">]</span><span class="op">/</span><span class="va">close</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">close</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>

<span class="co">## Create plot of price series and add to worksheet</span>
<span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">prices</span>, <span class="fu">aes</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="va">Date</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">Close</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
<span class="fu">geom_line</span><span class="op">(</span>colour<span class="op">=</span><span class="st">"royalblue2"</span><span class="op">)</span> <span class="op">+</span>
<span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Date"</span>, y <span class="op">=</span> <span class="st">"Price"</span>, title <span class="op">=</span> <span class="va">ticker</span><span class="op">)</span> <span class="op">+</span>
<span class="fu">geom_area</span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"royalblue1"</span>,alpha <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span> <span class="op">+</span>
<span class="fu">coord_cartesian</span><span class="op">(</span>ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">prices</span><span class="op">$</span><span class="va">Close</span><span class="op">)</span><span class="op">-</span><span class="fl">1.5</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">prices</span><span class="op">$</span><span class="va">Close</span><span class="op">)</span><span class="op">+</span><span class="fl">1.5</span><span class="op">)</span><span class="op">)</span> 

<span class="co">## Add worksheet and write plot to sheet</span>
<span class="fu"><a href="../reference/addWorksheet.html">addWorksheet</a></span><span class="op">(</span><span class="va">wb</span>, sheetName <span class="op">=</span> <span class="st">"CBA"</span><span class="op">)</span>
<span class="fu"><a href="../reference/insertPlot.html">insertPlot</a></span><span class="op">(</span><span class="va">wb</span>, sheet <span class="op">=</span> <span class="fl">1</span>, xy <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"J"</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span>

<span class="co">## Histogram of log returns</span>
<span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">prices</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">logReturns</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_bar</span><span class="op">(</span>binwidth<span class="op">=</span><span class="fl">0.0025</span><span class="op">)</span> <span class="op">+</span>
<span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Histogram of log returns"</span><span class="op">)</span>

<span class="co">## currency </span>
<span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">prices</span><span class="op">$</span><span class="va">Close</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"currency"</span> <span class="co">## styles as currency in workbook</span>

<span class="co">## write historical data and  histogram of returns</span>
<span class="fu"><a href="../reference/writeDataTable.html">writeDataTable</a></span><span class="op">(</span><span class="va">wb</span>, sheet <span class="op">=</span> <span class="st">"CBA"</span>, x <span class="op">=</span> <span class="va">prices</span><span class="op">)</span>
<span class="fu"><a href="../reference/insertPlot.html">insertPlot</a></span><span class="op">(</span><span class="va">wb</span>, sheet <span class="op">=</span> <span class="fl">1</span>, startRow<span class="op">=</span><span class="fl">25</span>, startCol <span class="op">=</span> <span class="st">"J"</span><span class="op">)</span>

<span class="co">## Add conditional formatting to show where logReturn &gt; 0.01 using default style</span>
<span class="fu"><a href="../reference/conditionalFormat.html">conditionalFormat</a></span><span class="op">(</span><span class="va">wb</span>, sheet <span class="op">=</span> <span class="fl">1</span>, cols <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">prices</span><span class="op">)</span>, rows <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">prices</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span>,
rule <span class="op">=</span> <span class="st">"$H2 &gt; 0.01"</span><span class="op">)</span>

<span class="co">## style log return col as a percentage  </span>
<span class="va">logRetStyle</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createStyle.html">createStyle</a></span><span class="op">(</span>numFmt <span class="op">=</span> <span class="st">"percentage"</span><span class="op">)</span>

<span class="fu"><a href="../reference/addStyle.html">addStyle</a></span><span class="op">(</span><span class="va">wb</span>, <span class="fl">1</span>, style <span class="op">=</span> <span class="va">logRetStyle</span>, rows <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">prices</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span>, 
cols <span class="op">=</span> <span class="st">"H"</span>, gridExpand <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="fu"><a href="../reference/setColWidths.html">setColWidths</a></span><span class="op">(</span><span class="va">wb</span>, sheet<span class="op">=</span><span class="fl">1</span>, cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"F"</span>, <span class="st">"G"</span>, <span class="st">"H"</span><span class="op">)</span>, widths <span class="op">=</span> <span class="fl">15</span><span class="op">)</span>

<span class="co">## save workbook to working directory</span>
<span class="fu"><a href="../reference/saveWorkbook.html">saveWorkbook</a></span><span class="op">(</span><span class="va">wb</span>, <span class="st">"stockPrice.xlsx"</span>, overwrite <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="../reference/openXL.html">openXL</a></span><span class="op">(</span><span class="st">"stockPrice.xlsx"</span><span class="op">)</span></code></pre></div>
</div>
<div id="image-compression-using-pca" class="section level3">
<h3 class="hasAnchor">
<a href="#image-compression-using-pca" class="anchor"></a>Image Compression using PCA</h3>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="kw">require</span>(openxlsx)</span>
<span id="cb17-2"><a href="#cb17-2"></a><span class="kw">require</span>(jpeg)</span>
<span id="cb17-3"><a href="#cb17-3"></a><span class="kw">require</span>(ggplot2)</span>
<span id="cb17-4"><a href="#cb17-4"></a></span>
<span id="cb17-5"><a href="#cb17-5"></a>plotFn &lt;-<span class="st"> </span><span class="cf">function</span>(x, ...){</span>
<span id="cb17-6"><a href="#cb17-6"></a>  colvec &lt;-<span class="st"> </span><span class="kw">grey</span>(x)</span>
<span id="cb17-7"><a href="#cb17-7"></a>  colmat &lt;-<span class="st"> </span><span class="kw">array</span>(<span class="kw">match</span>(colvec, <span class="kw">unique</span>(colvec)), <span class="dt">dim =</span> <span class="kw">dim</span>(x)[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>])</span>
<span id="cb17-8"><a href="#cb17-8"></a>  <span class="kw">image</span>(<span class="dt">x =</span> <span class="dv">0</span><span class="op">:</span>(<span class="kw">dim</span>(colmat)[<span class="dv">2</span>]), <span class="dt">y =</span> <span class="dv">0</span><span class="op">:</span>(<span class="kw">dim</span>(colmat)[<span class="dv">1</span>]), <span class="dt">z =</span> <span class="kw">t</span>(colmat[<span class="kw">nrow</span>(colmat)<span class="op">:</span><span class="dv">1</span>, ]),</span>
<span id="cb17-9"><a href="#cb17-9"></a>    <span class="dt">col =</span> <span class="kw">unique</span>(colvec), <span class="dt">xlab =</span> <span class="st">""</span>, <span class="dt">ylab =</span> <span class="st">""</span>, <span class="dt">axes =</span> <span class="ot">FALSE</span>, <span class="dt">asp =</span> <span class="dv">1</span>,</span>
<span id="cb17-10"><a href="#cb17-10"></a>    <span class="dt">bty =</span><span class="st">"n"</span>, <span class="dt">frame.plot=</span>F, <span class="dt">ann=</span><span class="ot">FALSE</span>)</span>
<span id="cb17-11"><a href="#cb17-11"></a>}</span>
<span id="cb17-12"><a href="#cb17-12"></a></span>
<span id="cb17-13"><a href="#cb17-13"></a><span class="co">## Create workbook and add a worksheet, hide gridlines</span></span>
<span id="cb17-14"><a href="#cb17-14"></a>wb &lt;-<span class="st"> </span><span class="kw">createWorkbook</span>(<span class="st">"Einstein"</span>)</span>
<span id="cb17-15"><a href="#cb17-15"></a><span class="kw">addWorksheet</span>(wb, <span class="st">"Original Image"</span>, <span class="dt">gridLines =</span> <span class="ot">FALSE</span>)</span>
<span id="cb17-16"><a href="#cb17-16"></a></span>
<span id="cb17-17"><a href="#cb17-17"></a>A &lt;-<span class="st"> </span><span class="kw">readJPEG</span>(<span class="kw">file.path</span>(<span class="kw">path.package</span>(<span class="st">"openxlsx"</span>), <span class="st">"einstein.jpg"</span>))</span>
<span id="cb17-18"><a href="#cb17-18"></a>height &lt;-<span class="st"> </span><span class="kw">nrow</span>(A); width &lt;-<span class="st"> </span><span class="kw">ncol</span>(A)</span>
<span id="cb17-19"><a href="#cb17-19"></a></span>
<span id="cb17-20"><a href="#cb17-20"></a><span class="co">## write "Original Image" to cell B2</span></span>
<span id="cb17-21"><a href="#cb17-21"></a><span class="kw">writeData</span>(wb, <span class="dv">1</span>, <span class="st">"Original Image"</span>, <span class="dt">xy =</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb17-22"><a href="#cb17-22"></a></span>
<span id="cb17-23"><a href="#cb17-23"></a><span class="co">## write Object size to cell B3</span></span>
<span id="cb17-24"><a href="#cb17-24"></a><span class="kw">writeData</span>(wb, <span class="dv">1</span>, <span class="kw">sprintf</span>(<span class="st">"Image object size: %s bytes"</span>,</span>
<span id="cb17-25"><a href="#cb17-25"></a>                         <span class="kw">format</span>(<span class="kw">object.size</span>(A<span class="op">+</span><span class="dv">0</span>)[[<span class="dv">1</span>]], <span class="dt">big.mark=</span><span class="st">','</span>)), </span>
<span id="cb17-26"><a href="#cb17-26"></a>          <span class="dt">xy =</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">3</span>))  <span class="co">## equivalent to startCol = 2, startRow = 3</span></span>
<span id="cb17-27"><a href="#cb17-27"></a></span>
<span id="cb17-28"><a href="#cb17-28"></a><span class="co">## Plot image</span></span>
<span id="cb17-29"><a href="#cb17-29"></a><span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">rep</span>(<span class="dv">0</span>, <span class="dv">4</span>), <span class="dt">xpd =</span> <span class="ot">NA</span>); <span class="kw">plotFn</span>(A)</span>
<span id="cb17-30"><a href="#cb17-30"></a></span>
<span id="cb17-31"><a href="#cb17-31"></a><span class="co">## insert plot currently showing in plot window</span></span>
<span id="cb17-32"><a href="#cb17-32"></a><span class="kw">insertPlot</span>(wb, <span class="dv">1</span>, width, height, <span class="dt">units=</span><span class="st">"px"</span>, <span class="dt">startRow=</span> <span class="dv">5</span>, <span class="dt">startCol =</span> <span class="dv">2</span>)       </span>
<span id="cb17-33"><a href="#cb17-33"></a></span>
<span id="cb17-34"><a href="#cb17-34"></a><span class="co">## SVD of covariance matrix</span></span>
<span id="cb17-35"><a href="#cb17-35"></a>rMeans &lt;-<span class="st"> </span><span class="kw">rowMeans</span>(A)</span>
<span id="cb17-36"><a href="#cb17-36"></a>rowMeans &lt;-<span class="st"> </span><span class="kw">do.call</span>(<span class="st">"cbind"</span>, <span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(A), <span class="cf">function</span>(X) rMeans))</span>
<span id="cb17-37"><a href="#cb17-37"></a>A &lt;-<span class="st"> </span>A <span class="op">-</span><span class="st"> </span>rowMeans</span>
<span id="cb17-38"><a href="#cb17-38"></a>E &lt;-<span class="st"> </span><span class="kw">svd</span>(A <span class="op">%*%</span><span class="st"> </span><span class="kw">t</span>(A) <span class="op">/</span><span class="st"> </span>(<span class="kw">ncol</span>(A) <span class="op">-</span><span class="st"> </span><span class="dv">1</span>)) <span class="co"># SVD on covariance matrix of A</span></span>
<span id="cb17-39"><a href="#cb17-39"></a>pve &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="st">"Eigenvalues"</span> =<span class="st"> </span>E<span class="op">$</span>d, </span>
<span id="cb17-40"><a href="#cb17-40"></a>                  <span class="st">"PVE"</span> =<span class="st"> </span>E<span class="op">$</span>d<span class="op">/</span><span class="kw">sum</span>(E<span class="op">$</span>d),</span>
<span id="cb17-41"><a href="#cb17-41"></a>                  <span class="st">"Cumulative PVE"</span> =<span class="st"> </span><span class="kw">cumsum</span>(E<span class="op">$</span>d<span class="op">/</span><span class="kw">sum</span>(E<span class="op">$</span>d)))</span>
<span id="cb17-42"><a href="#cb17-42"></a></span>
<span id="cb17-43"><a href="#cb17-43"></a><span class="co">## write eigenvalues to worksheet</span></span>
<span id="cb17-44"><a href="#cb17-44"></a><span class="kw">addWorksheet</span>(wb, <span class="st">"Principal Component Analysis"</span>)</span>
<span id="cb17-45"><a href="#cb17-45"></a>hs &lt;-<span class="st"> </span><span class="kw">createStyle</span>(<span class="dt">fontColour =</span> <span class="st">"#ffffff"</span>, <span class="dt">fgFill =</span> <span class="st">"#4F80BD"</span>,</span>
<span id="cb17-46"><a href="#cb17-46"></a>                  <span class="dt">halign =</span> <span class="st">"CENTER"</span>, <span class="dt">textDecoration =</span> <span class="st">"Bold"</span>,</span>
<span id="cb17-47"><a href="#cb17-47"></a>                  <span class="dt">border =</span> <span class="st">"TopBottomLeftRight"</span>, <span class="dt">borderColour =</span> <span class="st">"#4F81BD"</span>)</span>
<span id="cb17-48"><a href="#cb17-48"></a></span>
<span id="cb17-49"><a href="#cb17-49"></a><span class="kw">writeData</span>(wb, <span class="dv">2</span>, <span class="dt">x=</span><span class="st">"Proportions of variance explained by Eigenvector"</span> ,<span class="dt">startRow =</span> <span class="dv">2</span>)</span>
<span id="cb17-50"><a href="#cb17-50"></a><span class="kw">mergeCells</span>(wb, <span class="dt">sheet=</span><span class="dv">2</span>, <span class="dt">cols=</span><span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, <span class="dt">rows=</span><span class="dv">2</span>)</span>
<span id="cb17-51"><a href="#cb17-51"></a></span>
<span id="cb17-52"><a href="#cb17-52"></a><span class="kw">setColWidths</span>(wb, <span class="dv">2</span>, <span class="dt">cols =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dt">widths =</span> <span class="kw">c</span>(<span class="dv">14</span>, <span class="dv">12</span>, <span class="dv">15</span>))</span>
<span id="cb17-53"><a href="#cb17-53"></a><span class="kw">writeData</span>(wb, <span class="dv">2</span>, <span class="dt">x=</span>pve, <span class="dt">startRow =</span> <span class="dv">3</span>, <span class="dt">startCol =</span> <span class="dv">1</span>, <span class="dt">borders=</span><span class="st">"rows"</span>, <span class="dt">headerStyle=</span>hs)</span>
<span id="cb17-54"><a href="#cb17-54"></a></span>
<span id="cb17-55"><a href="#cb17-55"></a><span class="co">## Plots</span></span>
<span id="cb17-56"><a href="#cb17-56"></a>pve &lt;-<span class="st"> </span><span class="kw">cbind</span>(pve, <span class="st">"Ind"</span> =<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(pve))</span>
<span id="cb17-57"><a href="#cb17-57"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> pve[<span class="dv">1</span><span class="op">:</span><span class="dv">20</span>,], <span class="kw">aes</span>(<span class="dt">x =</span> Ind, <span class="dt">y =</span> <span class="dv">100</span><span class="op">*</span>PVE)) <span class="op">+</span></span>
<span id="cb17-58"><a href="#cb17-58"></a><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">"identity"</span>, <span class="dt">position =</span> <span class="st">"dodge"</span>) <span class="op">+</span></span>
<span id="cb17-59"><a href="#cb17-59"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">"Principal Component Index"</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">"Proportion of Variance Explained"</span>) <span class="op">+</span></span>
<span id="cb17-60"><a href="#cb17-60"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">col =</span> <span class="st">"blue"</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">3</span>, <span class="dt">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb17-61"><a href="#cb17-61"></a></span>
<span id="cb17-62"><a href="#cb17-62"></a><span class="co">## Write plot to worksheet 2</span></span>
<span id="cb17-63"><a href="#cb17-63"></a><span class="kw">insertPlot</span>(wb, <span class="dv">2</span>, <span class="dt">width =</span> <span class="dv">5</span>, <span class="dt">height =</span> <span class="dv">4</span>, <span class="dt">startCol =</span> <span class="st">"E"</span>, <span class="dt">startRow =</span> <span class="dv">2</span>) </span>
<span id="cb17-64"><a href="#cb17-64"></a></span>
<span id="cb17-65"><a href="#cb17-65"></a><span class="co">## Plot of cumulative explained variance</span></span>
<span id="cb17-66"><a href="#cb17-66"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> pve[<span class="dv">1</span><span class="op">:</span><span class="dv">50</span>,], <span class="kw">aes</span>(<span class="dt">x =</span> Ind, <span class="dt">y =</span> <span class="dv">100</span><span class="op">*</span>Cumulative.PVE)) <span class="op">+</span></span>
<span id="cb17-67"><a href="#cb17-67"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size=</span><span class="fl">2.5</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>(<span class="dt">size=</span><span class="dv">1</span>) <span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="st">"Number of PCs"</span>) <span class="op">+</span></span>
<span id="cb17-68"><a href="#cb17-68"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="st">"Cumulative Proportion of Variance Explained"</span>)</span>
<span id="cb17-69"><a href="#cb17-69"></a><span class="kw">insertPlot</span>(wb, <span class="dv">2</span>, <span class="dt">width =</span> <span class="dv">5</span>, <span class="dt">height =</span> <span class="dv">4</span>, <span class="dt">xy=</span> <span class="kw">c</span>(<span class="st">"M"</span>, <span class="dv">2</span>)) </span>
<span id="cb17-70"><a href="#cb17-70"></a></span>
<span id="cb17-71"><a href="#cb17-71"></a></span>
<span id="cb17-72"><a href="#cb17-72"></a><span class="co">## Reconstruct image using increasing number of PCs</span></span>
<span id="cb17-73"><a href="#cb17-73"></a>nPCs &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">12</span>, <span class="dv">20</span>, <span class="dv">50</span>, <span class="dv">200</span>)</span>
<span id="cb17-74"><a href="#cb17-74"></a>startRow &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">24</span>), <span class="dt">each =</span> <span class="dv">3</span>)</span>
<span id="cb17-75"><a href="#cb17-75"></a>startCol &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">"B"</span>, <span class="st">"H"</span>, <span class="st">"N"</span>), <span class="dv">2</span>)</span>
<span id="cb17-76"><a href="#cb17-76"></a></span>
<span id="cb17-77"><a href="#cb17-77"></a><span class="co">## create a worksheet to save reconstructed images to</span></span>
<span id="cb17-78"><a href="#cb17-78"></a><span class="kw">addWorksheet</span>(wb, <span class="st">"Reconstructed Images"</span>, <span class="dt">zoom =</span> <span class="dv">90</span>)</span>
<span id="cb17-79"><a href="#cb17-79"></a></span>
<span id="cb17-80"><a href="#cb17-80"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(nPCs)){</span>
<span id="cb17-81"><a href="#cb17-81"></a>  </span>
<span id="cb17-82"><a href="#cb17-82"></a>  V &lt;-<span class="st"> </span>E<span class="op">$</span>v[, <span class="dv">1</span><span class="op">:</span>nPCs[i]]</span>
<span id="cb17-83"><a href="#cb17-83"></a>  imgHat &lt;-<span class="st"> </span><span class="kw">t</span>(V) <span class="op">%*%</span><span class="st"> </span>A  <span class="co">## project img data on to PCs</span></span>
<span id="cb17-84"><a href="#cb17-84"></a>  imgSize &lt;-<span class="st"> </span><span class="kw">object.size</span>(V) <span class="op">+</span><span class="st"> </span><span class="kw">object.size</span>(imgHat) <span class="op">+</span><span class="st"> </span><span class="kw">object.size</span>(rMeans)</span>
<span id="cb17-85"><a href="#cb17-85"></a>  </span>
<span id="cb17-86"><a href="#cb17-86"></a>  imgHat &lt;-<span class="st"> </span>V <span class="op">%*%</span><span class="st"> </span>imgHat <span class="op">+</span><span class="st"> </span>rowMeans  <span class="co">## reconstruct from PCs and add back row means</span></span>
<span id="cb17-87"><a href="#cb17-87"></a>  imgHat &lt;-<span class="st"> </span><span class="kw">round</span>((imgHat <span class="op">-</span><span class="st"> </span><span class="kw">min</span>(imgHat)) <span class="op">/</span><span class="st"> </span>(<span class="kw">max</span>(imgHat) <span class="op">-</span><span class="st"> </span><span class="kw">min</span>(imgHat))<span class="op">*</span><span class="dv">255</span>) <span class="co"># scale</span></span>
<span id="cb17-88"><a href="#cb17-88"></a>  <span class="kw">plotFn</span>(imgHat<span class="op">/</span><span class="dv">255</span>)</span>
<span id="cb17-89"><a href="#cb17-89"></a>  </span>
<span id="cb17-90"><a href="#cb17-90"></a>  <span class="co">## write strings to worksheet 3</span></span>
<span id="cb17-91"><a href="#cb17-91"></a>  <span class="kw">writeData</span>(wb, <span class="st">"Reconstructed Images"</span>, </span>
<span id="cb17-92"><a href="#cb17-92"></a>            <span class="kw">sprintf</span>(<span class="st">"Number of principal components used:  %s"</span>, </span>
<span id="cb17-93"><a href="#cb17-93"></a>                    nPCs[[i]]), startCol[i], startRow[i])</span>
<span id="cb17-94"><a href="#cb17-94"></a>  </span>
<span id="cb17-95"><a href="#cb17-95"></a>  <span class="kw">writeData</span>(wb, <span class="st">"Reconstructed Images"</span>, </span>
<span id="cb17-96"><a href="#cb17-96"></a>            <span class="kw">sprintf</span>(<span class="st">"Sum of component object sizes: %s bytes"</span>,</span>
<span id="cb17-97"><a href="#cb17-97"></a>                    <span class="kw">format</span>(<span class="kw">as.numeric</span>(imgSize), <span class="dt">big.mark=</span><span class="st">','</span>)), startCol[i], startRow[i]<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb17-98"><a href="#cb17-98"></a>  </span>
<span id="cb17-99"><a href="#cb17-99"></a>  <span class="co">## write reconstruced image</span></span>
<span id="cb17-100"><a href="#cb17-100"></a>  <span class="kw">insertPlot</span>(wb, <span class="st">"Reconstructed Images"</span>, width, height, <span class="dt">units=</span><span class="st">"px"</span>,</span>
<span id="cb17-101"><a href="#cb17-101"></a>             <span class="dt">xy =</span> <span class="kw">c</span>(startCol[i], startRow[i]<span class="op">+</span><span class="dv">3</span>))</span>
<span id="cb17-102"><a href="#cb17-102"></a>  </span>
<span id="cb17-103"><a href="#cb17-103"></a>}</span>
<span id="cb17-104"><a href="#cb17-104"></a></span>
<span id="cb17-105"><a href="#cb17-105"></a><span class="co"># hide grid lines</span></span>
<span id="cb17-106"><a href="#cb17-106"></a><span class="kw">showGridLines</span>(wb, <span class="dt">sheet =</span> <span class="dv">3</span>, <span class="dt">showGridLines =</span> <span class="ot">FALSE</span>)</span>
<span id="cb17-107"><a href="#cb17-107"></a></span>
<span id="cb17-108"><a href="#cb17-108"></a><span class="co">## Make text above images BOLD</span></span>
<span id="cb17-109"><a href="#cb17-109"></a>boldStyle &lt;-<span class="st"> </span><span class="kw">createStyle</span>(<span class="dt">textDecoration=</span><span class="st">"BOLD"</span>)</span>
<span id="cb17-110"><a href="#cb17-110"></a></span>
<span id="cb17-111"><a href="#cb17-111"></a><span class="co">## only want to apply style to specified cells (not all combinations of rows &amp; cols)</span></span>
<span id="cb17-112"><a href="#cb17-112"></a><span class="kw">addStyle</span>(wb, <span class="st">"Reconstructed Images"</span>, <span class="dt">style=</span>boldStyle, </span>
<span id="cb17-113"><a href="#cb17-113"></a>         <span class="dt">rows =</span> <span class="kw">c</span>(startRow, startRow<span class="op">+</span><span class="dv">1</span>), <span class="dt">cols =</span> <span class="kw">rep</span>(startCol, <span class="dv">2</span>), </span>
<span id="cb17-114"><a href="#cb17-114"></a>         <span class="dt">gridExpand =</span> <span class="ot">FALSE</span>)  </span>
<span id="cb17-115"><a href="#cb17-115"></a></span>
<span id="cb17-116"><a href="#cb17-116"></a><span class="co">## save workbook to working directory</span></span>
<span id="cb17-117"><a href="#cb17-117"></a><span class="kw">saveWorkbook</span>(wb, <span class="st">"Image dimensionality reduction.xlsx"</span>, <span class="dt">overwrite =</span> <span class="ot">TRUE</span>) </span>
<span id="cb17-118"><a href="#cb17-118"></a></span>
<span id="cb17-119"><a href="#cb17-119"></a></span>
<span id="cb17-120"><a href="#cb17-120"></a></span>
<span id="cb17-121"><a href="#cb17-121"></a></span>
<span id="cb17-122"><a href="#cb17-122"></a><span class="co">## remove example files for cran test</span></span>
<span id="cb17-123"><a href="#cb17-123"></a><span class="cf">if</span> (<span class="kw">identical</span>(<span class="kw">Sys.getenv</span>(<span class="st">"NOT_CRAN"</span>, <span class="dt">unset =</span> <span class="st">"true"</span>), <span class="st">"false"</span>)) {</span>
<span id="cb17-124"><a href="#cb17-124"></a>file_list&lt;-<span class="kw">list.files</span>(<span class="dt">pattern=</span><span class="st">"</span><span class="ch">\\</span><span class="st">.xlsx"</span>,<span class="dt">recursive =</span> T)</span>
<span id="cb17-125"><a href="#cb17-125"></a>file_list&lt;-fl[<span class="op">!</span><span class="kw">grepl</span>(<span class="st">"inst/extdata"</span>,file_list)<span class="op">&amp;!</span><span class="kw">grepl</span>(<span class="st">"man/"</span>,file_list)]</span>
<span id="cb17-126"><a href="#cb17-126"></a></span>
<span id="cb17-127"><a href="#cb17-127"></a><span class="cf">if</span>(<span class="kw">length</span>(file_list)<span class="op">&gt;</span><span class="dv">0</span>){</span>
<span id="cb17-128"><a href="#cb17-128"></a><span class="kw">rm</span>(file_list)</span>
<span id="cb17-129"><a href="#cb17-129"></a>}</span></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Philipp Schauberger, Alexander Walker.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
